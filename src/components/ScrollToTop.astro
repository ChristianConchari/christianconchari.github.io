---
import Icon from './Icon.astro';
---

<button
  id="scroll-to-top-button"
  aria-label="Scroll back to top"
  class="fixed bottom-8 right-8 z-50 flex h-12 w-12 translate-y-4 items-center justify-center rounded-full bg-primary text-background-dark opacity-0 transition-all duration-300 hover:scale-110 hover:bg-secondary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 pointer-events-none"
>
  <Icon name="chevron-up" class="h-5 w-5" />
</button>

<script>
  const SCROLL_VISIBILITY_THRESHOLD_PX = 300;

  const scrollToTopButton = document.getElementById('scroll-to-top-button');

  if (scrollToTopButton) {
    const showButton = () => {
      scrollToTopButton.classList.remove('opacity-0', 'translate-y-4', 'pointer-events-none');
      scrollToTopButton.classList.add('opacity-100', 'translate-y-0');
    };

    const hideButton = () => {
      scrollToTopButton.classList.remove('opacity-100', 'translate-y-0');
      scrollToTopButton.classList.add('opacity-0', 'translate-y-4', 'pointer-events-none');
    };

    const syncButtonVisibilityWithScrollPosition = () => {
      if (window.scrollY > SCROLL_VISIBILITY_THRESHOLD_PX) {
        showButton();
      } else {
        hideButton();
      }
    };

    window.addEventListener('scroll', syncButtonVisibilityWithScrollPosition, { passive: true });

    scrollToTopButton.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  }
</script>
