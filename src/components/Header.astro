---
import '../styles/global.css';
import HeaderInitials from './HeaderInitials.astro';
import ThemeToggle from './ThemeToggle.astro';
import MenuIcon from '../assets/icons/menu.svg';
interface Props {
  activeSection?: string;
}

const { activeSection } = Astro.props;

const navItems = [
  { number: '01', label: 'About Me', href: '#about' },
  { number: '02', label: 'Experience', href: '#experience' },
  { number: '03', label: 'Projects', href: '#projects' },
  { number: '04', label: 'Publications', href: '#publications' },
  { number: '05', label: 'Contact', href: '#contact' },
];
---

<header
  class="bg-background-light dark:bg-background-dark transition-colors duration-300"
>
  <div
    class="flex items-center justify-between gap-2 p-4 md:gap-4 md:px-6 md:py-4 lg:gap-8"
  >
    <HeaderInitials />

    <!-- Menu Toggle (Mobile) -->
    <button
      class="group flex cursor-pointer flex-col gap-1.25 border-none bg-transparent p-0 md:hidden"
      id="menuToggle"
      aria-label="Toggle menu"
    >
      <span class="text-teal-400 [&>svg]:h-5 [&>svg]:w-5"><MenuIcon /></span>
    </button>

    <!-- Nav Menu -->
    <nav
      class="bg-background-light dark:bg-background-dark absolute top-15 right-0 left-0 z-50 max-h-0 overflow-hidden border-b transition-[max-height,background-color] duration-300 md:static md:flex md:max-h-none md:flex-1 md:overflow-visible md:border-none [&.active]:max-h-105"
      id="navMenu"
    >
      <ul
        class="m-0 flex list-none flex-col gap-0 p-4 text-gray-800 md:flex-row md:gap-8 md:p-0"
      >
        {
          navItems.map((item) => (
            <li class="border-primary/10 border-b py-3 last:border-none md:border-none md:py-0">
              <a
                href={item.href}
                class="lg:text-1xl flex flex-col items-start gap-1 font-mono whitespace-nowrap transition-colors duration-300 md:flex-row md:items-center md:gap-2 md:text-1xl"
              >
                <span class="inline text-xl font-bold text-teal-400 md:hidden lg:inline">
                  {item.number}
                </span>
                <span class="font-bold text-gray-800 dark:text-gray-100">
                  {item.label}
                </span>
              </a>
            </li>
          ))
        }
      </ul>
    </nav>

    <div class="flex items-center gap-2 md:gap-4">
      <ThemeToggle />
      <a
        href="#resume"
        class="border-primary text-primary hover:bg-primary/10 shrink-0 cursor-pointer rounded-xl border-2 px-3 py-1.5 font-mono text-sm no-underline transition-all duration-300 md:px-4 md:py-2 md:text-xs lg:px-6 lg:py-3 lg:text-lg"
      >
        Resume
      </a>
    </div>
  </div>
</header>

<script>
  const menuToggle = document.getElementById('menuToggle');
  const navMenu = document.getElementById('navMenu');

  menuToggle?.addEventListener('click', () => {
    navMenu?.classList.toggle('active');
    menuToggle.classList.toggle('active');
  });

  // Close menu when a link is clicked
  const navLinks = document.querySelectorAll("a[href^='#']");
  navLinks.forEach((link) => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      navMenu?.classList.remove('active');
      menuToggle?.classList.remove('active');

      const targetId = link.getAttribute('href');
      if (targetId && targetId !== '#') {
        const targetElement = document.querySelector(targetId);
        if (targetElement) {
          targetElement.scrollIntoView({ behavior: 'smooth' });
        }
      }
    });
  });
</script>
